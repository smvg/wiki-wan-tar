<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="description" content="Descripción general de la extensión de PPP por Ethernet">
<meta name="keywords" content="ppppppoe,  sample homepage">
<title>PPPoE | Tema 8: WAN</title>
<link rel="stylesheet" href="css/syntax.css">

<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
<!--<link rel="stylesheet" type="text/css" href="css/bootstrap.min.css">-->
<link rel="stylesheet" href="css/modern-business.css">
<!-- Latest compiled and minified CSS -->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link rel="stylesheet" href="css/customstyles.css">
<link rel="stylesheet" href="css/boxshadowproperties.css">
<!-- most color styles are extracted out to here -->
<link rel="stylesheet" href="css/theme-blue.css">

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js"></script>
<script src="js/jquery.navgoco.min.js"></script>


<!-- Latest compiled and minified JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
<!-- Anchor.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/anchor-js/4.2.0/anchor.min.js"></script>
<script src="js/toc.js"></script>
<script src="js/customscripts.js"></script>

<link rel="shortcut icon" href="images/favicon.ico">

<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link rel="alternate" type="application/rss+xml" title="tar-wiki-wan" href="http://0.0.0.0:4000/feed.xml">

    <script>
        $(document).ready(function() {
            // Initialize navgoco with default options
            $("#mysidebar").navgoco({
                caretHtml: '',
                accordion: true,
                openClass: 'active', // open
                save: false, // leave false or nav highlighting doesn't work right
                cookie: {
                    name: 'navgoco',
                    expires: false,
                    path: '/'
                },
                slide: {
                    duration: 400,
                    easing: 'swing'
                }
            });

            $("#collapseAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', false);
            });

            $("#expandAll").click(function(e) {
                e.preventDefault();
                $("#mysidebar").navgoco('toggle', true);
            });

        });

    </script>
    <script>
        $(function () {
            $('[data-toggle="tooltip"]').tooltip()
        })
    </script>
    <script>
        $(document).ready(function() {
            $("#tg-sb-link").click(function() {
                $("#tg-sb-sidebar").toggle();
                $("#tg-sb-content").toggleClass('col-md-9');
                $("#tg-sb-content").toggleClass('col-md-12');
                $("#tg-sb-icon").toggleClass('fa-toggle-on');
                $("#tg-sb-icon").toggleClass('fa-toggle-off');
            });
        });
    </script>
    

</head>
<body>
<!-- Navigation -->
<nav class="navbar navbar-inverse navbar-static-top">
    <div class="container topnavlinks">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="fa fa-home fa-lg navbar-brand" href="index.html">&nbsp;<span class="projectTitle"> Tema 8: WAN</span></a>
        </div>
        <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
            <ul class="nav navbar-nav navbar-right">
                <!-- toggle sidebar button -->
                <li><a id="tg-sb-link" href="#"><i id="tg-sb-icon" class="fa fa-toggle-on"></i> Nav</a></li>
                
                <!--comment out this block if you want to hide search-->
                <li>
                    <!--start search-->
                    <div id="search-demo-container">
                        <input type="text" id="search-input" placeholder="search...">
                        <ul id="results-container"></ul>
                    </div>
                    <script src="js/jekyll-search.js" type="text/javascript"></script>
                    <script type="text/javascript">
                            SimpleJekyllSearch.init({
                                searchInput: document.getElementById('search-input'),
                                resultsContainer: document.getElementById('results-container'),
                                dataSource: 'search.json',
                                searchResultTemplate: '<li><a href="{url}" title="PPPoE">{title}</a></li>',
                    noResultsText: 'No results found.',
                            limit: 10,
                            fuzzy: true,
                    })
                    </script>
                    <!--end search-->
                </li>
            </ul>
        </div>
        </div>
        <!-- /.container -->
</nav>

<!-- Page Content -->
<div class="container">
  <div id="main">
    <!-- Content Row -->
    <div class="row">
        
        
            <!-- Sidebar Column -->
            <div class="col-md-3" id="tg-sb-sidebar">
                

<ul id="mysidebar" class="nav">
  <li class="sidebarTitle">Indice </li>
  
  
  
      
  
  <li>
      <a title="Descripción general" href="#">Descripción general</a>
      <ul>
          
          
          
          <li><a title="Tecnologías WAN" href="index.html">Tecnologías WAN</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Conexiones Punto a Punto" href="#">Conexiones Punto a Punto</a>
      <ul>
          
          
          
          <li><a title="Descripción de Punto a Punto" href="punto_punto.html">Descripción de Punto a Punto</a></li>
          
          
          
          
          
          
          <li><a title="Operación de PPP" href="operacion_ppp.html">Operación de PPP</a></li>
          
          
          
          
          
          
          <li><a title="Implementación de PPP" href="implementacion_ppp.html">Implementación de PPP</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Conexiones Hub and Spoke" href="#">Conexiones Hub and Spoke</a>
      <ul>
          
          
          
          <li><a title="Descripción de Hub & Spoke" href="hub_spoke.html">Descripción de Hub & Spoke</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Conexiones Mesh" href="#">Conexiones Mesh</a>
      <ul>
          
          
          
          <li><a title="Descripción de Mesh" href="mesh.html">Descripción de Mesh</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Solución de problemas" href="#">Solución de problemas</a>
      <ul>
          
          
          
          <li><a title="Conectividad WAN" href="solucion.html">Conectividad WAN</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Conexiones de sucursal" href="#">Conexiones de sucursal</a>
      <ul>
          
          
          
          <li><a title="Conexiones de acceso remoto" href="conexiones_remoto.html">Conexiones de acceso remoto</a></li>
          
          
          
          
          
          
          <li class="active"><a title="PPPoE" href="pppoe.html">PPPoE</a></li>
          
          
          
          
          
          
          <li><a title="VPN" href="vpn.html">VPN</a></li>
          
          
          
          
          
          
          <li><a title="GRE" href="gre.html">GRE</a></li>
          
          
          
          
          
          
          <li><a title="eBGP" href="ebgp.html">eBGP</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Glosario" href="#">Glosario</a>
      <ul>
          
          
          
          <li><a title="De la A a la I" href="glosario_a_i.html">De la A a la I</a></li>
          
          
          
          
          
          
          <li><a title="De la J a la R" href="glosario_j_r.html">De la J a la R</a></li>
          
          
          
          
          
          
          <li><a title="De la S a la Z" href="glosario_s_z.html">De la S a la Z</a></li>
          
          
          
          
      </ul>
   </li>
     
      
  
  <li>
      <a title="Bibliografía" href="#">Bibliografía</a>
      <ul>
          
          
          
          <li><a title="Descripción general" href="biblio_1.html">Descripción general</a></li>
          
          
          
          
          
          
          <li><a title="Conexiones Punto a Punto" href="biblio_2.html">Conexiones Punto a Punto</a></li>
          
          
          
          
          
          
          <li><a title="Conexiones Hub and Spoke" href="biblio_3.html">Conexiones Hub and Spoke</a></li>
          
          
          
          
          
          
          <li><a title="Conexiones Mesh" href="biblio_4.html">Conexiones Mesh</a></li>
          
          
          
          
          
          
          <li><a title="Solución de Problemas" href="biblio_5.html">Solución de Problemas</a></li>
          
          
          
          
          
          
          <li><a title="Conexiones de Sucursal" href="biblio_6.html">Conexiones de Sucursal</a></li>
          
          
          
          
      </ul>
   </li>
     
      
      
      <!-- if you aren't using the accordion, uncomment this block:
         <p class="external">
             <a href="#" id="collapseAll">Collapse All</a> | <a href="#" id="expandAll">Expand All</a>
         </p>
         -->
</ul>

<!-- this highlights the active parent class in the navgoco sidebar. this is critical so that the parent expands when you're viewing a page. This must appear below the sidebar code above. Otherwise, if placed inside customscripts.js, the script runs before the sidebar code runs and the class never gets inserted.-->
<script>$("li.active").parents('li').toggleClass("active");</script>

            </div>
            
        

        <!-- Content Column -->
        <div class="col-md-9" id="tg-sb-content">
            <div class="post-header">
   <h1 class="post-title-main">PPPoE</h1>
</div>



<div class="post-content">

   
    <div class="summary">Descripción general de la extensión de PPP por Ethernet</div>
   

    
    
<!-- this handles the automatic toc. use ## for subheads to auto-generate the on-page minitoc. if you use html tags, you must supply an ID for the heading element in order for it to appear in the minitoc. -->
<script>
$( document ).ready(function() {
  // Handler for .ready() called.

$('#toc').toc({ minimumHeaders: 0, listType: 'ul', showSpeed: 0, headers: 'h2,h3,h4' });

/* this offset helps account for the space taken up by the floating toolbar. */
$('#toc').on('click', 'a', function() {
  var target = $(this.getAttribute('href'))
    , scroll_target = target.offset().top

  $(window).scrollTop(scroll_target - 10);
  return false
})
  
});
</script>

<div id="toc"></div>

    


    

    <a target="_blank" rel="noopener" href="https://github.com/smvg/tar-wiki-wan/blob/gh-pages/pages/mydoc/pppoe.md" class="btn btn-default githubEditButton" role="button"><i class="fa fa-github fa-lg"></i> Edítame</a>

    

   <h2 id="descripción">Descripción</h2>
<p>En el punto anterior hemos hablado sobre las conexiones que normalmente utilizan los clientes de los proveedores para acceder a internet. ¿Pero qué conexiones utilizan las ISP?</p>

<p>Como ya explicamos uno de los protocolos de capa de enlace que se utiliza es PPP. Las ISP utilizan este protocolo ya que les permite asignar direcciones IP a extremos remotos de un enlace además de autentificar las conexiones. PPP permite utilizar enlaces de diferentes tipos entre los que se encuentra el protocolo <em>PPPoE</em>, el cuál permite el envío de tramas PPP encapsuladas dentro de tramas de Ethernet.</p>

<p>PPPoE permite que las operadoras permanezcan utilizando el protocolo PPP sin quitarle al usuario la comodidad que supone utilizar interfaces conocidas y compatibles como lo es la interfaz Ethernet.</p>

<h2 id="configuración">Configuración</h2>

<div class="alert alert-info" role="alert"><i class="fa fa-info-circle"></i> <b>Nota:</b> Los comandos que se motrarán son para sistemas CISCO.</div>

<p>Para configurar una comunicación utilizando el protocolo PPP entre dos dispositivos es necesario seguir los pasos a continuación.</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">interface</span> <span class="n">dialer</span> <span class="n">X</span> <span class="c1"># X siendo el número de la interfaz del marcador. Esto no es la interfaz física.
</span><span class="n">encapsulation</span> <span class="n">ppp</span>
<span class="n">ip</span> <span class="n">address</span> <span class="n">negotiated</span>

<span class="c1"># Estas credenciales deben coincidir con las credenciales que residen en el router del cliente
</span><span class="n">ppp</span> <span class="n">chap</span> <span class="n">hostname</span> <span class="n">NOMBRE</span>
<span class="n">ppp</span> <span class="n">chap</span> <span class="n">password</span> <span class="n">PASSWORD</span>

<span class="n">ip</span> <span class="n">mtu</span> <span class="mi">1492</span> <span class="c1"># Utilizamos 1492 ya que el valor predeterminado (1500) no funcionará con PPPoE
</span><span class="n">dialer</span> <span class="n">pool</span> <span class="n">X</span> <span class="c1"># X siendo un número que le asignaremos al pool. Este número lo utilizaremos después.
</span><span class="n">no</span> <span class="n">shutdown</span>

<span class="n">interface</span> <span class="n">INTERFAZ</span> <span class="c1"># INTERFAZ siendo la interfaz que está conectada al módem
</span><span class="n">no</span> <span class="n">ip</span> <span class="n">address</span>
<span class="n">pppoe</span> <span class="n">enable</span>
<span class="n">pppoe</span><span class="o">-</span><span class="n">client</span> <span class="n">dial</span><span class="o">-</span><span class="n">pool</span><span class="o">-</span><span class="n">number</span> <span class="n">X</span> <span class="c1"># X siendo el número que previamente le asignamos al pool.
</span><span class="n">no</span> <span class="n">shutdown</span>
</code></pre></div></div>

<div class="bs-callout bs-callout-primary">El MTU máximo pasa a ser  de 1492 ya que PPPoE necesita unos 8 bytes adicionales para su encabezado.</div>

<h3 id="1-verificación-de-pppoe">1. Verificación de PPPoE</h3>
<p>Para verificar que la configuración que hemos aplicado y guardado es la correcta utilizamos los siguientes comandos:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>show ip interface brief <span class="c"># Nos sirve para verificar que la interfaz del marcador está activa</span>
show interface dialer <span class="c"># Con esto verificamos que el MTU es de 1492 y la encapsulación es PPP</span>
show ip route <span class="c"># Con este comando comprobamos la tabla de routing</span>
show pppoe session <span class="c"># Muestra las sesiones PPPoE actualmente activas</span>
</code></pre></div></div>
<p>A pesar de haber configurado correctamente los dispositivos, pueden seguir surgiendo razones por las que nuestra conexión PPPoE no funciona correctamente.</p>

<h4 id="11-fallo-en-la-negociación-del-pppoe">1.1 Fallo en la negociación del PPPoE</h4>
<p>Este fallo se puede dar si:</p>
<ul>
  <li>Falla del protocolo de control de IP</li>
  <li>No hay respuesta del dispositivo remoto</li>
  <li>El LCP no se ha abierto</li>
  <li>Error al autentificar las credenciales</li>
</ul>

<p><br />
Para depurar este tipo de errores se utiliza:</p>
<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>debug ppp negotiation <span class="c"># Aquí se mostrará la información de los 4 puntos mencionados anteriormente</span>
</code></pre></div></div>

<h4 id="12-fallo-de-autentificación">1.2 Fallo de autentificación</h4>
<p>Si se cree que el error que se produce es de autentificación, se puede consultar la verificación de las credenciales con el comando:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>debug ppp negotiation <span class="c"># En caso de no coincidir mostrará "FAILURE" en la salida del comando</span>
</code></pre></div></div>

<h4 id="13-sesiones-tcp-descartadas">1.3 Sesiones TCP descartadas</h4>
<p>En el caso de que la configuración muestre incosistencias al manejar sesiones TCP, esto se puede ser por no configurar el tamaño máximo de segmento. Esto se puede configurar de la siguiente manera:</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>ip tcp adjust-mss 1452 <span class="c"># 1452 es el valor recomendado</span>
</code></pre></div></div>


    <div class="tags">
        
        <b>Tags: </b>
        
        
        
        <a href="tag_ppp.html" class="btn btn-default navbar-btn cursorNorm" role="button">ppp</a>
        
        
        
        <a href="tag_pppoe.html" class="btn btn-default navbar-btn cursorNorm" role="button">pppoe</a>
        
        
        
    </div>


<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
    var pathname = window.location.pathname
    var id = (window.location.pathname === "/") ? "/index.html" : pathname
    //this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = id; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://https-smvg-github-io-tar-wiki-wan.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>



</div>

<hr class="shaded"/>

<footer>
            <div class="row">
                <div class="col-lg-12 footer">
               Samuel Martín Vargas Giagnocavo<br />
Página generada: Apr 28, 2020 <br />
<p><img style="margin-top: 10px" width=172 height=64 src="images/company_logo.png" alt="UAL"/></p>
                </div>
            </div>
</footer>


        </div>
    <!-- /.row -->
</div>
<!-- /.container -->
</div>
<!-- /#main -->
    </div>

</body>

</html>
